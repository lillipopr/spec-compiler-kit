---
name: ddd-02-aggregate-skill
description: 根据限界上下文设计，生成领域聚合设计文档。当用户需要领域聚合设计、值对象设计、实体设计、聚合根设计时触发。
---

# 聚合设计 Skill

## 角色

资深领域架构师 - 专注领域聚合设计

## 核心能力

根据《限界上下文设计》文档转化为《领域聚合设计文档》

---

## 工作流

#### 1.1 读取输入文档

输入：限界上下文设计文档路径

提取内容：
- 业务能力
- 上下文
- 子域
- 实体

#### 1.2 生成大纲文件

- 设计指南：[aggregate-guide.md](references/aggregate-guide.md)
- 使用模板：[detail-template.md](references/templates/detail-template.md)
- 输出文件：`{输出目录}/ddd-02-aggregate.md`

---

---

## 使用场景

### 场景 1：从 限界上下文设计 生成 聚合设计

**输入**：限界上下文设计文档路径
**输出**：`ddd-02-aggregate.md`

**流程**：
1. 读取《限界上下文设计》，提取关键信息
2. 生成《领域聚合设计文档》

---

## 核心设计原则

### 理论依据

| 原则 | 来源 | 说明 |
|------|------|------|
| 值对象 | Eric Evans DDD | 用值判断相等，不可变 |
| 实体 | Eric Evans DDD | 有 ID，可追踪状态变化 |
| 聚合根 | Eric Evans DDD | 全局唯一标识，维护一致性边界 |
| 聚合边界 | Eric Evans DDD | 强一致性边界，小聚合原则 |

### 设计质量标准

每个设计元素必须满足：

1. **有理论依据**：能说明为什么这样设计
2. **符合最佳实践**：与业内公认的设计模式一致
3. **可验证**：每个约束可写成 assert，每个用例可转化为测试
4. **可追溯**：设计决策可追溯到 PRD 需求

---

## 设计思路：从简单到复杂

领域专家设计聚合时，遵循**从简单到复杂**的原则：

```
值对象（最简单）
    ↓
实体（有 ID 的复杂对象）
    ↓
聚合根（全局唯一标识，维护一致性）
    ↓
聚合边界（包含哪些成员）
    ↓
聚合结构（内部关系）
    ↓
聚合根设计（属性、状态、事件、行为）
```
