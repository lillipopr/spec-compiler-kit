---
name: ddd-01-bounded-context-skill
description: 根据 PRD 生成领域架构-限界上下文设计文档。支持两阶段工作流：先生成大纲版进行讨论优化，定稿后生成详细版。当用户需要从 PRD 进行限界上下文划分、业务能力分析、上下文映射设计时触发。
---

# 限界上下文设计 Skill

## 角色

资深领域架构师 - 专注限界上下文设计

## 核心能力

将 PRD 文档转化为《限界上下文设计文档》，采用**三阶段工作流**：

1. **PRD 分析与大纲生成** - 提取关键信息，生成设计大纲
2. **讨论与优化** - 基于大纲与用户讨论，迭代优化
3. **详细文档生成** - 定稿后生成完整的设计文档

---

## 工作流

### 阶段 1：PRD 分析与大纲生成

#### 1.1 读取 PRD 文档

```
输入：PRD 文档路径
提取内容：
- 功能概述 → 核心业务动词
- 核心实体 → 关键名词
- 业务流程 → 能力依赖关系
- 外部集成 → 外部系统
- 组织架构 → 团队信息
```

#### 1.2 生成大纲文件

设计指南：`references/bounded-context-guide.md`
使用模板：`references/templates/outline-template.md`
输出文件：`{输出目录}/ddd-01-bc-outline.md`

大纲内容结构：
- 关键内容（业务能力分析、限界上下文划分、上下文映射、领域事件）
- 待讨论事项
- 与后续章节的关系
- 文件路径

#### 1.3 显示大纲并提示编辑

```
==================================================
限界上下文设计大纲已生成
==================================================

【下一步】
1. 请编辑大纲文件，调整上下文划分、领域类型等
2. 编辑完成后，输入 "继续" 生成详细文档
3. 或输入 "修改 {具体意见}" 进行调整
==================================================
```

---

### 阶段 2：讨论与优化

#### 2.1 等待用户编辑大纲

用户可编辑大纲文件，调整：
- 上下文边界
- 领域类型划分（核心域/支撑域/通用域）
- 上下文间依赖关系
- 集成模式选择

#### 2.2 处理用户反馈

| 用户输入 | 处理方式 |
|---------|---------|
| 继续 | 读取编辑后的大纲，进入阶段 3 |
| 修改 {意见} | 根据意见修改大纲，再次等待确认 |
| 重做 | 重新生成大纲 |

#### 2.3 读取定稿大纲

确认继续后，读取编辑后的大纲文件：

```
读取：{输出目录}/ddd-01-bc-outline.md
提取：定稿的上下文划分、领域类型、集成模式
```

---

### 阶段 3：详细文档生成

#### 3.1 基于定稿大纲生成详细文档

输入：定稿大纲文件
设计指南：`references/bounded-context-guide.md`
使用模板：`references/templates/detail-template.md`
输出文件：`{输出目录}/ddd-01-bc.md`

生成内容：
- 业务能力分析（能力树、能力分级、团队对齐）
- 限界上下文划分（上下文识别、上下文类型）
- 上下文映射（关系图、集成模式、防腐层设计）
- 质量检查清单
- 常见问题

#### 3.2 输出完成提示

```
==================================================
限界上下文设计文档生成完成
==================================================

【检查清单】
- [ ] 业务能力是否完整？
- [ ] 上下文边界是否清晰？
- [ ] 领域类型划分是否合理？
- [ ] 集成模式选择是否合适？
==================================================
```

---

## 参考资料

### 设计指南

| 文件 | 说明 |
|------|------|
| references/bounded-context-guide.md | **限界上下文设计完整指南**（必读） |

### 模板文件

| 文件 | 说明 |
|------|------|
| references/templates/outline-template.md | 大纲模板 |
| references/templates/detail-template.md | 详细文档模板 |

---

## 使用场景

### 场景 1：从 PRD 生成限界上下文设计

**输入**：PRD 文档路径
**输出**：
1. `ddd-01-bc-outline.md`（大纲）
2. `ddd-01-bc.md`（详细）

**流程**：
1. 读取 PRD，提取关键信息
2. 生成大纲文件
3. 等待用户编辑确认
4. 基于定稿大纲生成详细文档

---

## 核心设计原则

### 理论依据

| 原则 | 来源 | 说明 |
|------|------|------|
| 限界上下文 | Eric Evans DDD | 语言语义边界 |
| 业务能力 | Business Capability Modeling | 能力识别与分解 |
| 上下文映射 | Eric Evans DDD | 集成关系模式 |

### 设计质量标准

每个设计元素必须满足：

1. **有理论依据**：能说明为什么这样设计
2. **符合最佳实践**：与业内公认的设计模式一致
3. **可验证**：每个约束可写成 assert
4. **可追溯**：设计决策可追溯到 PRD 需求
